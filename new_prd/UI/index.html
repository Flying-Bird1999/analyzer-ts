<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç»„ä»¶åº“èµ„äº§ç®¡ç†ç³»ç»Ÿ - UIåŸå‹</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <div class="logo">
        <div class="logo-icon">âš¡</div>
        <div class="logo-text">ç»„ä»¶åº“èµ„äº§ç®¡ç†ç³»ç»Ÿ</div>
      </div>
      <div class="header-right">
        <div class="version-selector" onclick="toggleVersionDropdown(event)">
          <span>v1.2.3</span>
          <span class="version-badge">Latest</span>
          <span class="version-dropdown-icon">â–¼</span>

          <!-- ç‰ˆæœ¬ä¸‹æ‹‰èœå• -->
          <div class="version-dropdown-menu" id="versionDropdown" onclick="event.stopPropagation()">
            <div class="version-dropdown-header">é€‰æ‹©ç‰ˆæœ¬</div>

            <div class="version-dropdown-item active" onclick="selectVersion('v1.2.3', event)">
              <span class="version">v1.2.3</span>
              <span class="check-icon">âœ“</span>
              <span class="version-badge" style="font-size: 11px;">Latest</span>
            </div>

            <div class="version-dropdown-item" onclick="selectVersion('v1.2.2', event)">
              <span class="version">v1.2.2</span>
              <span class="check-icon" style="opacity: 0;">âœ“</span>
            </div>

            <div class="version-dropdown-item" onclick="selectVersion('v1.2.1', event)">
              <span class="version">v1.2.1</span>
              <span class="check-icon" style="opacity: 0;">âœ“</span>
            </div>

            <div class="version-dropdown-item" onclick="selectVersion('v1.2.0', event)">
              <span class="version">v1.2.0</span>
              <span class="check-icon" style="opacity: 0;">âœ“</span>
            </div>

            <div class="version-dropdown-item" onclick="selectVersion('v1.1.0', event)">
              <span class="version">v1.1.0</span>
              <span class="check-icon" style="opacity: 0;">âœ“</span>
            </div>

            <div class="version-dropdown-footer">
              <a href="#" onclick="showVersionCompare(event); return false;">
                <span>âš–ï¸</span>
                <span>ç‰ˆæœ¬å¯¹æ¯”</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div style="display: flex">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="nav-item active" onclick="showPage('dashboard', event)">
          <span>ğŸ“Š</span>
          <span>æ¦‚è§ˆ Dashboard</span>
        </div>
        <div class="nav-item" onclick="showPage('components', event)">
          <span>ğŸ§©</span>
          <span>ç»„ä»¶åˆ—è¡¨ Components</span>
        </div>
        <div class="nav-item" onclick="showPage('dependencies', event)">
          <span>ğŸ”—</span>
          <span>ä¾èµ– Dependencies</span>
        </div>
        <div class="nav-item" onclick="showPage('standards', event)">
          <span>ğŸ“</span>
          <span>è§„èŒƒä¸å·¥å…· Standards</span>
        </div>
        <div class="nav-item" onclick="showPage('changelog', event)">
          <span>ğŸ”„</span>
          <span>å˜æ›´å†å² Changelog</span>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content" style="width: 100%">
        <!-- Dashboard Page -->
        <div id="page-dashboard-container"></div>

        <!-- Components Page -->
        <div id="page-components-container"></div>

        <!-- Component Detail Page -->
        <div id="page-component-detail-container"></div>

        <!-- Dependencies Page -->
        <div id="page-dependencies-container"></div>

        <!-- Standards Page -->
        <div id="page-standards-container"></div>

        <!-- Changelog Page -->
        <div id="page-changelog-container"></div>
      </div>
    </div>

    <script>
      // ç‰ˆæœ¬é€‰æ‹©å™¨
      let currentVersion = 'v1.2.3';

      function toggleVersionDropdown(event) {
        event.stopPropagation();
        const dropdown = document.getElementById('versionDropdown');
        const selector = event.currentTarget;

        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          selector.classList.remove('open');
        } else {
          dropdown.classList.add('show');
          selector.classList.add('open');
        }
      }

      function selectVersion(version, event) {
        event.stopPropagation();
        currentVersion = version;
        const dropdown = document.getElementById('versionDropdown');
        const selector = document.querySelector('.version-selector');

        // æ›´æ–°ä¸‹æ‹‰èœå•é€‰ä¸­çŠ¶æ€
        dropdown.querySelectorAll('.version-dropdown-item').forEach(item => {
          item.classList.remove('active');
          const checkIcon = item.querySelector('.check-icon');
          if (checkIcon) {
            checkIcon.style.opacity = '0';
          }
        });

        // è®¾ç½®å½“å‰é€‰ä¸­é¡¹
        event.currentTarget.classList.add('active');
        event.currentTarget.querySelector('.check-icon').style.opacity = '1';

        // æ›´æ–°é€‰æ‹©å™¨æ˜¾ç¤º
        const versionSpan = selector.querySelector('.version-selector > span:first-child');
        versionSpan.textContent = version;

        // å…³é—­ä¸‹æ‹‰èœå•
        dropdown.classList.remove('show');
        selector.classList.remove('open');

        console.log('åˆ‡æ¢åˆ°ç‰ˆæœ¬:', version);
        // TODO: è¿™é‡Œå¯ä»¥æ·»åŠ åˆ‡æ¢ç‰ˆæœ¬åçš„é€»è¾‘ï¼Œæ¯”å¦‚é‡æ–°åŠ è½½æ•°æ®
      }

      function showVersionCompare(event) {
        event.preventDefault();
        console.log('æ˜¾ç¤ºç‰ˆæœ¬å¯¹æ¯”');
        // TODO: å®ç°ç‰ˆæœ¬å¯¹æ¯”åŠŸèƒ½
        alert('ç‰ˆæœ¬å¯¹æ¯”åŠŸèƒ½å¼€å‘ä¸­...\n\nå¯¹æ¯”å½“å‰é€‰ä¸­ç‰ˆæœ¬ä¸å…¶ä»–ç‰ˆæœ¬çš„å·®å¼‚');
      }

      // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰èœå•
      document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('versionDropdown');
        const selector = document.querySelector('.version-selector');
        if (dropdown && selector) {
          dropdown.classList.remove('show');
          selector.classList.remove('open');
        }
      });

      // Tab Switching
      function switchTab(element, tabId, groupName) {
        console.log('switchTab called:', { tabId, groupName });
        // Hide all tab contents with the same group
        document
          .querySelectorAll('.tab-content[data-group="' + groupName + '"]')
          .forEach((content) => {
            content.style.display = 'none';
            content.classList.remove('active');
          });
        // Show selected tab content
        const targetContent = document.getElementById(tabId);
        if (targetContent) {
          targetContent.style.display = 'block';
          targetContent.classList.add('active');
          console.log('Tab content shown:', tabId);
        } else {
          console.error('Tab content not found:', tabId);
        }
        // Update tab styles
        element
          .closest('.tabs')
          .querySelectorAll('.tab')
          .forEach((tab) => {
            tab.classList.remove('active');
          });
        element.classList.add('active');
      }

      // é¡µé¢åŠ è½½å®Œæˆåï¼ŒåŠ¨æ€åŠ è½½å„ä¸ªé¡µé¢æ¨¡å—
      document.addEventListener('DOMContentLoaded', async function () {
        const pages = [
          'dashboard',
          'components',
          'component-detail',
          'dependencies',
          'standards',
          'changelog',
        ];

        // å¹¶è¡ŒåŠ è½½æ‰€æœ‰é¡µé¢
        const loadPromises = pages.map(async (page) => {
          try {
            const response = await fetch(`./pages/${page}.html`);
            const content = await response.text();
            const container = document.getElementById(`page-${page}-container`);
            if (container) {
              // ç›´æ¥æ’å…¥å†…å®¹ï¼Œä¿æŒåŸæœ‰çš„ page div å’Œ active ç±»
              container.innerHTML = content;
            }
          } catch (error) {
            console.error(`Failed to load ${page}:`, error);
            // æ˜¾ç¤ºé”™è¯¯æç¤º
            const container = document.getElementById(`page-${page}-container`);
            if (container) {
              container.innerHTML = `
                <div class="page" id="page-${page}" style="padding: 40px; text-align: center;">
                  <h3 style="color: #f5222d;">âš ï¸ é¡µé¢åŠ è½½å¤±è´¥</h3>
                  <p style="color: #666; margin-top: 16px;">
                    è¯·ç¡®ä¿åœ¨ HTTP æœåŠ¡å™¨ç¯å¢ƒä¸‹è¿è¡Œæ­¤é¡µé¢
                  </p>
                  <p style="color: #999; font-size: 13px; margin-top: 8px;">
                    é”™è¯¯ä¿¡æ¯: ${error.message}
                  </p>
                  <div style="margin-top: 24px; padding: 16px; background: #f5f5f5; border-radius: 8px; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto;">
                    <strong style="color: #333;">ğŸ’¡ è§£å†³æ–¹æ³•:</strong>
                    <ol style="margin: 12px 0 0 20px; color: #666; font-size: 13px; line-height: 1.8;">
                      <li>Python: <code>python3 -m http.server 8000</code></li>
                      <li>Node.js: <code>npx http-server</code></li>
                      <li>VSCode: å®‰è£… Live Server æ‰©å±•</li>
                    </ol>
                  </div>
                </div>
              `;
            }
          }
        });

        await Promise.all(loadPromises);

        // é¡µé¢åŠ è½½å®Œæˆåï¼Œé»˜è®¤æ˜¾ç¤ºç¬¬ä¸€ä¸ªé¡µé¢
        initializePages();
      });

      function initializePages() {
        // ç§»é™¤æ‰€æœ‰é¡µé¢çš„ active ç±»
        document.querySelectorAll('.page').forEach((page) => {
          page.classList.remove('active');
        });

        // é»˜è®¤æ¿€æ´» Dashboard é¡µé¢
        const dashboard = document.getElementById('page-dashboard');
        if (dashboard) {
          dashboard.classList.add('active');
        }
      }

      // Page Navigation
      function showPage(pageId, event) {
        console.log('showPage called:', pageId);

        // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœæ˜¯ component-detailï¼Œéœ€è¦ä» components é¡µé¢è·³è½¬
        if (pageId === 'component-detail') {
          // éšè—æ‰€æœ‰é¡µé¢
          document.querySelectorAll('.page').forEach((page) => {
            page.classList.remove('active');
          });

          // æ˜¾ç¤º component-detail é¡µé¢
          const detailPage = document.getElementById('page-component-detail');
          if (detailPage) {
            detailPage.classList.add('active');
          }
        } else {
          // éšè—æ‰€æœ‰é¡µé¢
          document.querySelectorAll('.page').forEach((page) => {
            page.classList.remove('active');
          });

          // æ˜¾ç¤ºé€‰ä¸­çš„é¡µé¢
          const targetPage = document.getElementById('page-' + pageId);
          if (targetPage) {
            targetPage.classList.add('active');
            console.log('Added active class to:', pageId);
          } else {
            console.error('Page not found:', pageId);
          }
        }

        // æ›´æ–°å¯¼èˆªé¡¹çŠ¶æ€
        document.querySelectorAll('.nav-item').forEach((item) => {
          item.classList.remove('active');
        });
        if (event && event.target) {
          event.target.closest('.nav-item').classList.add('active');
        }
      }
    </script>
  </body>
</html>
