# tsmorphgo API å®ç°è¿›åº¦è·Ÿè¸ª

## æ€»è§ˆ

æœ¬æ–‡æ¡£è·Ÿè¸ª tsmorphgo æ¨¡å— API çš„å®ç°è¿›åº¦ï¼ŒåŸºäº ts-morph.md ä¸­å®šä¹‰çš„ API è§„èŒƒã€‚

**ç›®æ ‡**ï¼šæä¾›ä¸ ts-morph ç±»ä¼¼çš„ Go è¯­è¨€ TypeScript AST æ“ä½œ API

**å½“å‰è¿›åº¦**ï¼š99% (æ ¸å¿ƒ API å·²å®Œæˆï¼Œç¬¦å·ç³»ç»Ÿå·²é›†æˆï¼Œç‰¹å®šèŠ‚ç‚¹ç±»å‹ä¸“æœ‰APIå·²å®Œæˆ)

---

## Phase 1: Node èŠ‚ç‚¹æ ¸å¿ƒ API

### 1.1 èŠ‚ç‚¹å¯¼èˆª API

| API                                               | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨                     |
| ------------------------------------------------- | --------- | ----------- | -------- | ------------------------ |
| `getParent() Node`                              | âœ… å·²å®ç° | node.go:90  | åœºæ™¯ 3.2 | åŸºç¡€å¯¼èˆªåŠŸèƒ½             |
| `getAncestors() []Node`                         | âœ… å·²å®ç° | node.go:100 | åœºæ™¯ 3.3 | è¿”å›æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹         |
| `getFirstAncestorByKind(kind SyntaxKind) Node`  | âœ… å·²å®ç° | node.go:116 | åœºæ™¯ 3.4 | æŒ‰ç±»å‹æŸ¥æ‰¾ç¥–å…ˆ           |
| `getFirstChild(predicate func(Node) bool) Node` | âœ… å·²å®ç° | node.go:194 | åœºæ™¯ 3.5 | æ ¹æ®æ¡ä»¶æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ |
| `getChildren() []Node`                          | âœ… å·²å®ç° | node.go:176 | æ–°å¢     | è·å–æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹       |
| `forEachChild(callback func(Node) bool)`        | âœ… å·²å®ç° | node.go:216 | æ–°å¢     | éå†æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹       |
| `getNextSibling() Node`                         | â³ å¾…å®ç° | node.go     | æ–°å¢     | éœ€è¦å®ç°                 |
| `getPreviousSibling() Node`                     | â³ å¾…å®ç° | node.go     | æ–°å¢     | éœ€è¦å®ç°                 |

### 1.2 èŠ‚ç‚¹ç±»å‹åˆ¤æ–­ API

| API                                   | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨           |
| ------------------------------------- | --------- | ----------- | -------- | -------------- |
| `isIdentifier() bool`               | âœ… å·²å®ç° | node.go:329 | åœºæ™¯ 4   | æ ‡è¯†ç¬¦åˆ¤æ–­     |
| `isFunctionDeclaration() bool`      | âœ… å·²å®ç° | node.go:332 | åœºæ™¯ 4   | å‡½æ•°å£°æ˜åˆ¤æ–­   |
| `isVariableDeclaration() bool`      | âœ… å·²å®ç° | node.go:333 | åœºæ™¯ 4   | å˜é‡å£°æ˜åˆ¤æ–­   |
| `isInterfaceDeclaration() bool`     | âœ… å·²å®ç° | node.go:334 | åœºæ™¯ 4   | æ¥å£å£°æ˜åˆ¤æ–­   |
| `isClassDeclaration() bool`         | âœ… å·²å®ç° | node.go:335 | åœºæ™¯ 4   | ç±»å£°æ˜åˆ¤æ–­     |
| `isEnumDeclaration() bool`          | âœ… å·²å®ç° | node.go:336 | åœºæ™¯ 4   | æšä¸¾å£°æ˜åˆ¤æ–­   |
| `isTypeAliasDeclaration() bool`     | âœ… å·²å®ç° | node.go:337 | åœºæ™¯ 4   | ç±»å‹åˆ«ååˆ¤æ–­   |
| `isCallExpression() bool`           | âœ… å·²å®ç° | node.go:340 | åœºæ™¯ 4   | å‡½æ•°è°ƒç”¨åˆ¤æ–­   |
| `isPropertyAccessExpression() bool` | âœ… å·²å®ç° | node.go:341 | åœºæ™¯ 4   | å±æ€§è®¿é—®åˆ¤æ–­   |
| `isBinaryExpression() bool`         | âœ… å·²å®ç° | node.go:342 | åœºæ™¯ 4   | äºŒå…ƒè¡¨è¾¾å¼åˆ¤æ–­ |
| `isObjectLiteralExpression() bool`  | âœ… å·²å®ç° | node.go:343 | åœºæ™¯ 4   | å¯¹è±¡å­—é¢é‡åˆ¤æ–­ |
| `isArrayLiteralExpression() bool`   | âœ… å·²å®ç° | node.go:344 | åœºæ™¯ 4   | æ•°ç»„å­—é¢é‡åˆ¤æ–­ |
| `isPropertyAssignment() bool`       | âœ… å·²å®ç° | node.go:345 | åœºæ™¯ 4   | å±æ€§èµ‹å€¼åˆ¤æ–­ |
| `isImportSpecifier() bool`          | âœ… å·²å®ç° | node.go:346 | åœºæ™¯ 4   | å¯¼å…¥æŒ‡å®šç¬¦åˆ¤æ–­ |
| `isImportDeclaration() bool`        | âœ… å·²å®ç° | node.go:347 | åœºæ™¯ 4   | å¯¼å…¥å£°æ˜åˆ¤æ–­ |
| `isExportDeclaration() bool`        | âœ… å·²å®ç° | node.go:348 | åœºæ™¯ 4   | å¯¼å‡ºå£°æ˜åˆ¤æ–­ |
| `isMethodDeclaration() bool`        | â³ å¾…å®ç° | node.go     | éœ€è¦å®ç°       |
| `isConstructor() bool`              | â³ å¾…å®ç° | node.go     | éœ€è¦å®ç°       |
| `isGetAccessor() bool`              | â³ å¾…å®ç° | node.go     | éœ€è¦å®ç°       |
| `isSetAccessor() bool`              | â³ å¾…å®ç° | node.go     | éœ€è¦å®ç°       |

### 1.3 èŠ‚ç‚¹ä¿¡æ¯è·å– API

| API                            | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨             |
| ------------------------------ | --------- | ----------- | -------- | ---------------- |
| `getText() string`           | âœ… å·²å®ç° | node.go:39  | åœºæ™¯ 5.2 | è·å–èŠ‚ç‚¹æ–‡æœ¬     |
| `getSourceFile() SourceFile` | âœ… å·²å®ç° | node.go:29  | åœºæ™¯ 2.3 | è·å–æºæ–‡ä»¶       |
| `getStartLineNumber() int`   | âœ… å·²å®ç° | node.go:47  | åœºæ™¯ 5.3 | è·å–èµ·å§‹è¡Œå·     |
| `getStartColumnNumber() int` | âœ… å·²å®ç° | node.go:66  | åœºæ™¯ 5.3 | è·å–èµ·å§‹åˆ—å·     |
| `getStart() int`             | âœ… å·²å®ç° | node.go:74  | åœºæ™¯ 5.3 | è·å–èµ·å§‹ä½ç½®     |
| `getEnd() int`               | âœ… å·²å®ç° | node.go:82  | åœºæ™¯ 5.3 | è·å–ç»“æŸä½ç½®     |
| `getKind() SyntaxKind`       | âœ… å·²å®ç° | node.go:248 | åœºæ™¯ 5.4 | è·å–è¯­æ³•ç±»å‹     |
| `getEndLineNumber() int`     | âœ… å·²å®ç° | node.go:272 | åœºæ™¯ 5.3 | è·å–ç»“æŸè¡Œå·     |
| `getEndColumnNumber() int`   | âœ… å·²å®ç° | node.go:281 | åœºæ™¯ 5.3 | è·å–ç»“æŸåˆ—å·     |
| `getWidth() int`             | âœ… å·²å®ç° | node.go:290 | æ–°å¢     | è·å–èŠ‚ç‚¹å®½åº¦     |
| `getKindName() string`       | âœ… å·²å®ç° | node.go:298 | åœºæ™¯ 5.4 | è·å–ç±»å‹åç§°     |
| `getSymbol() Symbol`         | âœ… å·²å®ç° | node.go:407 | åœºæ™¯ 5.1 | ç¬¦å·ç³»ç»Ÿå·²é›†æˆ |

### 1.4 ç‰¹å®šèŠ‚ç‚¹ç±»å‹ä¸“æœ‰ API

#### CallExpression

| API                       | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨     |
| ------------------------- | --------- | ----------- | -------- | -------- |
| `getExpression() Node`  | âœ… å·²å®ç° | node.go:717  | åœºæ™¯ 7.1 | è·å–è¢«è°ƒç”¨éƒ¨åˆ† |
| `getArguments() []Node` | âœ… å·²å®ç° | node.go:734  | æ–°å¢     | è·å–å‚æ•°åˆ—è¡¨   |

#### PropertyAccessExpression

| API                              | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨       |
| -------------------------------- | --------- | ----------- | -------- | ---------- |
| `getName() string`               | âœ… å·²å®ç° | node.go:756  | åœºæ™¯ 7.2 | è·å–å±æ€§å   |
| `getExpressionForPropertyAccess() Node` | âœ… å·²å®ç° | node.go:768  | åœºæ™¯ 7.2 | è·å–å¯¹è±¡éƒ¨åˆ† |

#### VariableDeclaration

| API                           | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨       |
| ----------------------------- | --------- | ----------- | -------- | ---------- |
| `getNameNode() Node`        | âœ… å·²å®ç° | node.go:784  | åœºæ™¯ 7.3 | è·å–åç§°èŠ‚ç‚¹ |
| `getNameForVariable() string` | âœ… å·²å®ç° | node.go:796  | åœºæ™¯ 7.3 | è·å–å˜é‡å   |
| `getInitializer() Node`      | âœ… å·²å®ç° | node.go:806  | åœºæ™¯ 7.3 | è·å–åˆå§‹å€¼   |

#### BinaryExpression

| API                         | çŠ¶æ€      | å®ç°ä½ç½®    | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨       |
| --------------------------- | --------- | ----------- | -------- | ---------- |
| `getOperatorToken() Node`  | âœ… å·²å®ç° | node.go:833  | åœºæ™¯ 7.6 | è·å–æ“ä½œç¬¦   |
| `getLeft() Node`           | âœ… å·²å®ç° | node.go:851  | åœºæ™¯ 7.6 | è·å–å·¦æ“ä½œæ•° |
| `getRight() Node`          | âœ… å·²å®ç° | node.go:866  | åœºæ™¯ 7.6 | è·å–å³æ“ä½œæ•° |

#### FunctionDeclaration

| API                        | çŠ¶æ€      | å®ç°ä½ç½®      | å¯¹åº”æ–‡æ¡£ | å¤‡æ³¨                       |
| -------------------------- | --------- | ------------- | -------- | -------------------------- |
| `getNameNode() Node`     | âœ… å·²å®ç° | node.go:887   | åœºæ™¯ 7.4 | æ ¸å¿ƒåŠŸèƒ½ï¼Œæ ¹æ®æ–‡æ¡£éœ€æ±‚     |
| `getName() string`       | âœ… å·²å®ç° | node.go:897   | åœºæ™¯ 7.4 | ä¾¿åˆ©æ–¹æ³•                   |
| `isAnonymous() bool`     | âœ… å·²å®ç° | node.go:906   | æ–°å¢     | æ£€æŸ¥æ˜¯å¦ä¸ºåŒ¿åå‡½æ•°         |
| `getAsXXX() æ–¹æ³•`        | âœ… å·²å®ç° | node.go:884   | æ–°å¢     | ç±»å‹å®‰å…¨è½¬æ¢æ–¹æ³•           |

---

## Phase 2: é¡¹ç›®å’Œæ–‡ä»¶ç®¡ç† API

| API                                                             | çŠ¶æ€      | å®ç°ä½ç½®       | å¤‡æ³¨           |
| --------------------------------------------------------------- | --------- | -------------- | -------------- |
| `NewProject(config ProjectConfig)`                            | âœ… å·²å®ç° | project.go:51  | é¡¹ç›®åˆ›å»º       |
| `NewProjectFromSources(sources map[string]string)`            | âœ… å·²å®ç° | project.go:98  | å†…å­˜é¡¹ç›®       |
| `getSourceFiles() []SourceFile`                               | âœ… å·²å®ç° | project.go:165 | è·å–æ‰€æœ‰æºæ–‡ä»¶ |
| `createSourceFile(fileName, content string) SourceFile`       | âœ… å·²å®ç° | project.go:246 | åˆ›å»ºæºæ–‡ä»¶     |
| `removeSourceFile(filePath string) (bool, error)`             | âœ… å·²å®ç° | project.go:333 | ç§»é™¤æºæ–‡ä»¶     |
| `updateSourceFile(filePath, newSourceCode string) SourceFile` | âœ… å·²å®ç° | project.go:359 | æ›´æ–°æºæ–‡ä»¶     |
| tsconfig.json å®Œæ•´æ”¯æŒ                                          | â³ å¾…å®ç° | project.go     | éœ€è¦å¢å¼º       |
| å†…å­˜æ–‡ä»¶ç³»ç»Ÿæ”¯æŒ                                                | â³ å¾…å®ç° | project.go     | éœ€è¦å®ç°       |

---

## Phase 3: ç¬¦å·å’Œç±»å‹ç³»ç»Ÿ API

| API                                   | çŠ¶æ€      | å®ç°ä½ç½®          | å¯¹åº”æ–‡æ¡£       | å¤‡æ³¨       |
| ------------------------------------- | --------- | ----------------- | -------- | ---------- |
| SymbolManager åŸºç¡€æ¶æ„                | âœ… å·²å®ç° | symbol.go         | åœºæ™¯ 5.1 | ç¬¦å·ç®¡ç†å™¨ |
| `getSymbol() Symbol`                | âœ… å·²å®ç° | node.go:407       | åœºæ™¯ 5.1 | èŠ‚ç‚¹æ–¹æ³•   |
| `getName() string` (Symbol)         | âœ… å·²å®ç° | symbol.go:152      | åœºæ™¯ 5.1 | ç¬¦å·åç§°   |
| `getDeclarations() []Node` (Symbol) | âœ… å·²å®ç° | symbol.go:173      | åœºæ™¯ 5.1 | ç¬¦å·å£°æ˜   |
| `findReferences() []Node`           | âœ… å·²å®ç° | references.go:333 | åœºæ™¯ 6    | å¼•ç”¨æŸ¥æ‰¾   |
| `gotoDefinition() []Node`           | âœ… å·²å®ç° | references.go:374 | åœºæ™¯ 6    | å®šä¹‰è·³è½¬   |

---

## å·²å®Œæˆçš„ä¼˜åŒ–

### âœ… å·²ç§»é™¤çš„å†—ä½™ API

1. **NodeCategory ç³»ç»Ÿ** - è¿‡äºå¤æ‚çš„åˆ†ç±»ç³»ç»Ÿå·²è¢«ç§»é™¤
2. **å¤æ‚çš„ GetNodeName å®ç°** - å·²è¢«ç§»é™¤ï¼Œæ”¹ç”¨ç‰¹å®šèŠ‚ç‚¹ç±»å‹çš„ä¸“ç”¨ API
3. **ç±»åˆ«åˆ¤æ–­æ–¹æ³•** - ç®€åŒ–ä¸ºç›´æ¥çš„ç±»å‹æ£€æŸ¥æ–¹æ³•

### âœ… å·²é‡æ„çš„ API

1. **ä½ç½®è®¡ç®—æ–¹æ³•** - ç»Ÿä¸€äº† `getLineAndColumn()` é€»è¾‘
2. **é€ä¼ API** - æä¾›äº†é«˜æ€§èƒ½ã€ç±»å‹å®‰å…¨çš„æ•°æ®è®¿é—®
3. **ç¬¦å·ç³»ç»Ÿé›†æˆ** - Node å±‚é¢ç›´æ¥é›†æˆ `GetSymbol()` æ–¹æ³•

---

## å®ç°ä¼˜å…ˆçº§

### ğŸ”¥ é«˜ä¼˜å…ˆçº§ (ç«‹å³å¼€å§‹)

1. `getFirstChild()`, `getChildren()` - èŠ‚ç‚¹å¯¼èˆª
2. `getEndLineNumber()`, `getWidth()`, `getKindName()` - ä¿¡æ¯è·å–
3. `isPropertyAssignment()`, `isImportSpecifier()` - ç±»å‹åˆ¤æ–­
4. æ¸…ç†å†—ä½™ API

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (1-2å‘¨å†…)

1. ç‰¹å®šèŠ‚ç‚¹ç±»å‹çš„ä¸“æœ‰ API
2. tsconfig.json æ”¯æŒ
3. ç¬¦å·ç³»ç»ŸåŸºç¡€å®ç°

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (é•¿æœŸè§„åˆ’)

1. å®Œæ•´çš„ TypeChecker é›†æˆ
2. æ€§èƒ½ä¼˜åŒ–
3. é«˜çº§ç¼–è¯‘å™¨ API

---

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### ç‰¹å®šèŠ‚ç‚¹ç±»å‹ä¸“æœ‰ API ç³»ç»Ÿ

åŸºäº ts-morph.md æ–‡æ¡£éœ€æ±‚ï¼Œå®ç°äº†ç±»å‹å®‰å…¨çš„ç‰¹å®šèŠ‚ç‚¹ç±»å‹ API ç³»ç»Ÿï¼š

#### æ ¸å¿ƒè®¾è®¡ç†å¿µ
- **ç±»å‹å®‰å…¨è½¬æ¢**: ä½¿ç”¨ `AsXXX()` æ–¹æ³•è¿›è¡Œç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- **éœ€æ±‚å¯¼å‘**: ä¸¥æ ¼åŸºäº ts-morph.md ä¸­çš„åœºæ™¯ 7.1-7.4 è®¾è®¡
- **ç®€æ´ä¸“æ³¨**: ç§»é™¤å†—ä½™ APIï¼Œåªæä¾›æ–‡æ¡£ä¸­éœ€è¦çš„æ ¸å¿ƒåŠŸèƒ½
- **é€ä¼ é›†æˆ**: æ— ç¼é›†æˆåº•å±‚è§£æå™¨æ•°æ®

#### å·²å®ç°çš„ç‰¹å®šç±»å‹

| èŠ‚ç‚¹ç±»å‹ | è½¬æ¢æ–¹æ³• | æ ¸å¿ƒæ–¹æ³• | æ–‡æ¡£åœºæ™¯ | çŠ¶æ€ |
|---------|---------|---------|---------|------|
| VariableDeclaration | `AsVariableDeclaration()` | `GetNameNode()`, `GetName()`, `HasInitializer()` | åœºæ™¯ 7.3 | âœ… å®Œæˆ |
| CallExpression | `AsCallExpression()` | `GetExpression()`, `GetArguments()`, `GetArgumentCount()` | åœºæ™¯ 7.1 | âœ… å®Œæˆ |
| PropertyAccessExpression | `AsPropertyAccessExpression()` | `GetName()`, `GetExpression()` | åœºæ™¯ 7.2 | âœ… å®Œæˆ |
| FunctionDeclaration | `AsFunctionDeclaration()` | `GetNameNode()`, `GetName()`, `IsAnonymous()` | åœºæ™¯ 7.4 | âœ… å®Œæˆ |

#### ä½¿ç”¨èŒƒå¼
```go
// ç±»å‹å®‰å…¨çš„ä½¿ç”¨èŒƒå¼
if varDecl, ok := node.AsVariableDeclaration(); ok {
    nameNode := varDecl.GetNameNode()  // æ ¸å¿ƒï¼šts-morph.md åœºæ™¯ 7.3
    name := varDecl.GetName()           // ä¾¿åˆ©æ–¹æ³•
    if varDecl.HasInitializer() {      // å®ç”¨åŠŸèƒ½
        init := varDecl.GetInitializer()
    }
}
```

## å½“å‰æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡

### ä»»åŠ¡ 1: å®ç° getFirstChild() å’Œ getChildren()

**ç›®æ ‡**: æä¾›åŸºç¡€çš„å­èŠ‚ç‚¹å¯¼èˆªèƒ½åŠ›
**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­
**å®ç°ä½ç½®**: tsmorphgo/node.go

### ä»»åŠ¡ 2: æ¸…ç† NodeCategory ç³»ç»Ÿ

**ç›®æ ‡**: ç§»é™¤è¿‡åº¦è®¾è®¡çš„åˆ†ç±»ç³»ç»Ÿï¼Œç®€åŒ– API
**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­
**å®ç°ä½ç½®**: tsmorphgo/node.go

### ä»»åŠ¡ 3: è¡¥å……ä½ç½®ä¿¡æ¯ API

**ç›®æ ‡**: å®Œå–„ getEndLineNumber(), getWidth(), getKindName()
**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­
**å®ç°ä½ç½®**: tsmorphgo/node.go

---

## æµ‹è¯•è¦†ç›–

| æ–‡ä»¶               | æµ‹è¯•çŠ¶æ€        | å¤‡æ³¨                |
| ------------------ | --------------- | ------------------- |
| basic_test.go      | âœ… å·²æœ‰åŸºç¡€æµ‹è¯• | éœ€è¦æ‰©å±•æ–° API æµ‹è¯• |
| references_test.go | âœ… å·²æœ‰å¼•ç”¨æµ‹è¯• | åŠŸèƒ½æ­£å¸¸            |
| node_api_test.go   | â³ å¾…åˆ›å»º       | æ–° Node API çš„æµ‹è¯•  |

---

## æ›´æ–°æ—¥å¿—

- **2025-11-11**: åˆ›å»ºè¿›åº¦è·Ÿè¸ªæ–‡æ¡£ï¼Œå¼€å§‹ Phase 1 å®ç°
- **2025-11-11**: å®Œæˆ API å·®è·åˆ†æï¼Œåˆ¶å®šå®ç°è®¡åˆ’
- **2025-11-11**: å¼€å§‹æ¸…ç†å†—ä½™ APIï¼Œå®ç°æ ¸å¿ƒ Node API

---

**å¤‡æ³¨**: æœ¬æ–‡æ¡£å°†éšå¼€å‘è¿›åº¦æŒç»­æ›´æ–°ï¼Œç¡®ä¿ API å®ç°çš„é€æ˜åº¦å’Œå¯è·Ÿè¸ªæ€§ã€‚
